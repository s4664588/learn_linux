# SSH Tunnel å­¸ç¿’è¨˜éŒ„

> åŸºæ–¼ hello02923 çš„ã€ŒSSH å…¥é–€åŠ SSH Tunneléˆæ´»é‹ç”¨ã€æ–‡ç« å­¸ç¿’å¯¦ä½œ  
> åƒè€ƒï¼šhttps://ithelp.ithome.com.tw/articles/10290848  
> å­¸ç¿’æœŸé–“ï¼š2025å¹´10æœˆ - 30å¤©å®Œæ•´å­¸ç¿’è¨ˆç•«

## ğŸ“… Day 1: SSH Tunnel ä¸‰å±¤æ¶æ§‹ç†è§£èˆ‡ç’°å¢ƒå»ºç«‹

**å­¸ç¿’æ—¥æœŸ**: 2025-10-20  
**å­¸ç¿’é‡é»**: ç†è§£ SSH Tunnel æ ¸å¿ƒæ¦‚å¿µï¼Œå»ºç«‹å®Œæ•´æ¸¬è©¦ç’°å¢ƒ

### ğŸ¯ ä»Šæ—¥å­¸ç¿’ç›®æ¨™

1. **ç†è§£ SSH Tunnel ä¸‰å±¤æ¶æ§‹**
   - Client (PuTTY) - æœ¬æ©Ÿç”¨æˆ¶ç«¯
   - SSH Gateway (è·³æ¿ä¸»æ©Ÿ) - ä¸­ä»‹ä¼ºæœå™¨
   - Target Server (ç›®æ¨™ä¸»æ©Ÿ) - å…§éƒ¨æœå‹™

2. **å»ºç«‹ Docker æ¸¬è©¦ç’°å¢ƒ**
   - é…ç½®å¤šå®¹å™¨ç¶²è·¯ç’°å¢ƒ
   - å¯¦ç¾ç¶²è·¯éš”é›¢è¨­è¨ˆ
   - éƒ¨ç½²å®Œæ•´æ¸¬è©¦æ¶æ§‹

3. **æŒæ¡åŸºæœ¬æ“ä½œæµç¨‹**
   - ä½¿ç”¨äº’å‹•å¼æ¸¬è©¦å·¥å…·
   - é©—è­‰ç’°å¢ƒæ­£ç¢ºæ€§
   - ç†è§£æ ¸å¿ƒå·¥ä½œåŸç†

### ğŸ—ï¸ ç³»çµ±æ¶æ§‹å­¸ç¿’

#### æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker Compose ç’°å¢ƒ                      â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Client    â”‚    â”‚SSH Gateway  â”‚    â”‚Target Serverâ”‚      â”‚
â”‚  â”‚   (PuTTY)   â”‚â—„â”€â”€â–ºâ”‚ (è·³æ¿ä¸»æ©Ÿ)   â”‚â—„â”€â”€â–ºâ”‚ (ç›®æ¨™ä¸»æ©Ÿ)   â”‚      â”‚
â”‚  â”‚             â”‚    â”‚ Port: 2222  â”‚    â”‚ Port: 80,22 â”‚      â”‚
â”‚  â”‚             â”‚    â”‚ sshuser     â”‚    â”‚ Port: 3306  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚        â”‚                   â”‚                   â”‚            â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                            â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          Public Network â”‚ (172.30.0.0/16)            â”‚  â”‚
â”‚  â”‚          æœ¬æ©Ÿå¯ç›´æ¥å­˜å–   â”‚                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Internal Networkâ”‚ (10.100.0.0/24)            â”‚  â”‚
â”‚  â”‚         å…§éƒ¨éš”é›¢ç¶²è·¯     â”‚ (æœ¬æ©Ÿç„¡æ³•ç›´æ¥å­˜å–)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç¶²è·¯éš”é›¢è¨­è¨ˆ
- **Public Network** (172.30.0.0/16)ï¼šå¤–éƒ¨ç¶²è·¯ï¼Œæœ¬æ©Ÿå¯ç›´æ¥å­˜å–
- **Internal Network** (10.100.0.0/24)ï¼šå…§éƒ¨éš”é›¢ç¶²è·¯ï¼Œåƒ…èƒ½é€éè·³æ¿ä¸»æ©Ÿå­˜å–
- **å®‰å…¨åŸå‰‡**ï¼šå…§éƒ¨æœå‹™å®Œå…¨éš”é›¢ï¼Œå¿…é ˆé€é SSH Gateway æ‰èƒ½å­˜å–

### ğŸ³ Docker å®¹å™¨é…ç½®

#### SSH Gateway (è·³æ¿ä¸»æ©Ÿ)
```yaml
æœå‹™åç¨±: ssh-gateway
åŸºç¤æ˜ åƒ: Ubuntu 22.04 LTS
é€£æ¥åŸ : 2222:22 (å°å¤–é–‹æ”¾ SSH)
ç¶²è·¯: public-net, internal-net (æ©‹æ¥å…§å¤–ç¶²)
èªè­‰: sshuser / password123
åŠŸèƒ½: SSH æœå‹™ã€Port Forwardingã€ç¶²è·¯æ©‹æ¥
```

#### Target Server 1 (Web ä¼ºæœå™¨)
```yaml
æœå‹™åç¨±: target-server-1
åŸºç¤æ˜ åƒ: Ubuntu 22.04 LTS
é€£æ¥åŸ : 80 (Nginx), 22 (SSH)
ç¶²è·¯: internal-net (åƒ…å…§éƒ¨ç¶²è·¯)
èªè­‰: root / rootpassword
æœå‹™: Nginx Web Server
ç”¨é€”: æ¨¡æ“¬å…§éƒ¨ Web æ‡‰ç”¨ç³»çµ±
```

#### Target Server 2 (è³‡æ–™åº«ä¼ºæœå™¨)
```yaml
æœå‹™åç¨±: target-server-2
åŸºç¤æ˜ åƒ: Ubuntu 22.04 LTS
é€£æ¥åŸ : 22 (SSH), 3306 (MySQL)
ç¶²è·¯: internal-net (åƒ…å…§éƒ¨ç¶²è·¯)
èªè­‰: root / rootpassword, testuser / testpass (MySQL)
æœå‹™: MySQL Database Server
ç”¨é€”: æ¨¡æ“¬å…§éƒ¨è³‡æ–™åº«ç³»çµ±
```

### ğŸ”§ SSH Tunnel å¯¦ä½œåŸç†

#### Port Forwarding æ©Ÿåˆ¶
```bash
# åŸºæœ¬ SSH Tunnel èªæ³•
ssh -L [æœ¬æ©ŸPort]:[ç›®æ¨™ä¸»æ©Ÿ]:[ç›®æ¨™Port] -p [è·³æ¿Port] [è·³æ¿ç”¨æˆ¶]@[è·³æ¿IP]

# å¯¦éš›ç¯„ä¾‹
ssh -L 8080:target-server-1:80 -p 2222 sshuser@localhost
```

#### ä¸‰ç¨®ä¸»è¦ Tunnel é¡å‹
1. **Web æœå‹™ Tunnel**
   - æœ¬æ©Ÿ 8080 â†’ target-server-1:80
   - ç”¨é€”ï¼šå­˜å–å…§éƒ¨ Web æ‡‰ç”¨
   - æ¸¬è©¦ï¼š`curl http://localhost:8080`

2. **SSH æœå‹™ Tunnel**
   - æœ¬æ©Ÿ 8081 â†’ target-server-1:22
   - ç”¨é€”ï¼šSSH é€£æ¥å…§éƒ¨ä¼ºæœå™¨
   - æ¸¬è©¦ï¼š`ssh -p 8081 root@localhost`

3. **è³‡æ–™åº«æœå‹™ Tunnel**
   - æœ¬æ©Ÿ 8083 â†’ target-server-2:3306
   - ç”¨é€”ï¼šé€£æ¥å…§éƒ¨è³‡æ–™åº«
   - æ¸¬è©¦ï¼š`mysql -h localhost -P 8083 -u testuser -p`

### ğŸ› ï¸ è‡ªå‹•åŒ–å·¥å…·å­¸ç¿’

#### äº’å‹•å¼æ¸¬è©¦å·¥å…·åŠŸèƒ½
```powershell
.\putty-tunnel-test.ps1              # å•Ÿå‹•äº’å‹•å¼é¸å–®

# ä¸»è¦åŠŸèƒ½é¸é …ï¼š
# 1 - å®‰è£ PuTTY (è‡ªå‹•åŒ–å®‰è£)
# 2 - è¨­å®šæ¸¬è©¦ç’°å¢ƒ (Docker + PuTTY Session)
# 3 - åŸ·è¡Œ SSH Tunnel æ¸¬è©¦ (å®Œæ•´é©—è­‰)
# 4 - æ¸…ç†æ¸¬è©¦ç’°å¢ƒ (ç’°å¢ƒæ¸…ç†)
# 5 - åŸ·è¡Œå®Œæ•´æ¸¬è©¦æµç¨‹ (ä¸€éµå®Œæˆ)
# 6 - é¡¯ç¤º PuTTY æ‰‹å‹•æ“ä½œèªªæ˜
# 7 - æª¢æŸ¥ç’°å¢ƒç‹€æ…‹ (ç³»çµ±è¨ºæ–·)
# 0 - é€€å‡ºç¨‹å¼
```

#### PuTTY è‡ªå‹•åŒ–é…ç½®
- **Session åç¨±**: SSH-Gateway-Tunnels
- **é€£ç·šè¨­å®š**: localhost:2222, SSH
- **èªè­‰è³‡è¨Š**: sshuser / password123
- **Port Forwarding**: è‡ªå‹•é…ç½®ä¸‰å€‹ä¸»è¦ Tunnel

### ğŸ“‹ ä»Šæ—¥å¯¦ä½œæ­¥é©Ÿ

#### 1. ç’°å¢ƒæº–å‚™
```powershell
# æª¢æŸ¥ Docker ç’°å¢ƒ
docker --version
docker-compose --version

# æª¢æŸ¥å°ˆæ¡ˆæª”æ¡ˆ
ls common_tool/
```

#### 2. å•Ÿå‹•æ¸¬è©¦ç’°å¢ƒ
```powershell
# ä½¿ç”¨äº’å‹•å¼å·¥å…·
.\putty-tunnel-test.ps1

# é¸æ“‡é¸é … 2 - è¨­å®šæ¸¬è©¦ç’°å¢ƒ
# ç³»çµ±æœƒè‡ªå‹•ï¼š
# - å•Ÿå‹• Docker Compose
# - å»ºç«‹ PuTTY Session
# - ç­‰å¾…æœå‹™å°±ç·’
```

#### 3. é©—è­‰ç’°å¢ƒ
```powershell
# é¸æ“‡é¸é … 7 - æª¢æŸ¥ç’°å¢ƒç‹€æ…‹
# ç¢ºèªï¼š
# - PuTTY å·²å®‰è£
# - Docker å®¹å™¨é‹è¡Œæ­£å¸¸
# - ç¶²è·¯é€£é€šæ€§æ­£å¸¸
# - PuTTY Session å·²å»ºç«‹
```

#### 4. åŸ·è¡ŒåŸºç¤æ¸¬è©¦
```powershell
# é¸æ“‡é¸é … 3 - åŸ·è¡Œ SSH Tunnel æ¸¬è©¦
# é©—è­‰ï¼š
# - SSH Tunnel å»ºç«‹æˆåŠŸ
# - Port Forwarding æ­£å¸¸
# - å„é …æœå‹™å¯å­˜å–
```

### ğŸ¯ å­¸ç¿’æˆæœ

#### ç†è«–ç†è§£
- âœ… **SSH Tunnel åŸç†**ï¼šç†è§£ Port Forwarding å·¥ä½œæ©Ÿåˆ¶
- âœ… **ä¸‰å±¤æ¶æ§‹**ï¼šæŒæ¡ Client â†’ Gateway â†’ Target è¨­è¨ˆ
- âœ… **ç¶²è·¯éš”é›¢**ï¼šç†è§£å…§å¤–ç¶²åˆ†é›¢çš„å®‰å…¨æ¶æ§‹
- âœ… **ä¼æ¥­æ‡‰ç”¨**ï¼šäº†è§£è·³æ¿ä¸»æ©Ÿåœ¨ä¼æ¥­ç’°å¢ƒçš„é‡è¦æ€§

#### æŠ€è¡“å¯¦ä½œ
- âœ… **Docker ç’°å¢ƒ**ï¼šæˆåŠŸå»ºç«‹å¤šå®¹å™¨æ¸¬è©¦ç’°å¢ƒ
- âœ… **ç¶²è·¯é…ç½®**ï¼šå¯¦ç¾å…§å¤–ç¶²éš”é›¢è¨­è¨ˆ
- âœ… **æœå‹™éƒ¨ç½²**ï¼šéƒ¨ç½² SSHã€Webã€è³‡æ–™åº«æœå‹™
- âœ… **è‡ªå‹•åŒ–å·¥å…·**ï¼šæŒæ¡äº’å‹•å¼æ¸¬è©¦å·¥å…·ä½¿ç”¨

#### å¯¦éš›æ“ä½œ
- âœ… **PuTTY é…ç½®**ï¼šè‡ªå‹•å»ºç«‹ Session å’Œ Tunnel è¨­å®š
- âœ… **é€£ç·šæ¸¬è©¦**ï¼šé©—è­‰æ‰€æœ‰ SSH Tunnel åŠŸèƒ½
- âœ… **æ•…éšœæ’é™¤**ï¼šå­¸æœƒåŸºæœ¬çš„å•é¡Œè¨ºæ–·æ–¹æ³•
- âœ… **ç’°å¢ƒç®¡ç†**ï¼šæŒæ¡ç’°å¢ƒå•Ÿå‹•ã€æ¸¬è©¦ã€æ¸…ç†æµç¨‹

### ğŸ” é‡è¦æ¦‚å¿µæ•´ç†

#### SSH Tunnel æ ¸å¿ƒæ¦‚å¿µ
1. **Local Port Forwarding**: å°‡æœ¬æ©Ÿ Port è½‰ç™¼åˆ°é ç«¯æœå‹™
2. **è·³æ¿ä¸»æ©Ÿ**: ä½œç‚ºå…§å¤–ç¶²æ©‹æ¥çš„ä¸­ä»‹ä¼ºæœå™¨
3. **ç¶²è·¯éš”é›¢**: å…§éƒ¨æœå‹™å®Œå…¨éš”é›¢ï¼Œæé«˜å®‰å…¨æ€§
4. **Port Mapping**: æœ¬æ©Ÿ Port èˆ‡å…§éƒ¨æœå‹™çš„å°æ‡‰é—œä¿‚

#### ä¼æ¥­æ‡‰ç”¨å ´æ™¯
1. **é ç«¯è¾¦å…¬**: åœ¨å®¶å®‰å…¨å­˜å–å…¬å¸å…§éƒ¨ç³»çµ±
2. **ç³»çµ±ç®¡ç†**: é€éè·³æ¿æ©Ÿç¶­è­·å…§éƒ¨ä¼ºæœå™¨
3. **é–‹ç™¼ç’°å¢ƒ**: å®‰å…¨é€£æ¥å…§éƒ¨é–‹ç™¼å’Œæ¸¬è©¦è³‡æº
4. **è³‡æ–™åº«å­˜å–**: é€é SSH Tunnel é€£æ¥å…§éƒ¨è³‡æ–™åº«

#### å®‰å…¨æ€§è€ƒé‡
1. **èªè­‰æ©Ÿåˆ¶**: SSH é‡‘é‘°èªè­‰å„ªæ–¼å¯†ç¢¼èªè­‰
2. **å­˜å–æ§åˆ¶**: é™åˆ¶é€£ç·šä¾†æºå’Œç›®æ¨™
3. **æ—¥èªŒç›£æ§**: è¨˜éŒ„æ‰€æœ‰é€£ç·šæ´»å‹•
4. **æ¬Šé™ç®¡ç†**: æœ€å°æ¬Šé™åŸå‰‡

### ğŸ“š åƒè€ƒè³‡æ–™

#### æ ¸å¿ƒæ–‡ç« 
- **åŸå§‹æ–‡ç« **: [SSH å…¥é–€åŠ SSH Tunneléˆæ´»é‹ç”¨](https://ithelp.ithome.com.tw/articles/10290848)
- **ä½œè€…**: hello02923 (2022 iThome éµäººè³½)

#### æŠ€è¡“æ–‡ä»¶
- **Docker å®˜æ–¹æ–‡ä»¶**: https://docs.docker.com/
- **PuTTY å®˜æ–¹ç¶²ç«™**: https://www.putty.org/
- **OpenSSH æ–‡ä»¶**: https://www.openssh.com/

#### å°ˆæ¡ˆæª”æ¡ˆ (Day1 è³‡æ–™å¤¾)
- **å­¸ç¿’è¨˜éŒ„**: SSH-Tunnel-Learn-Record.md
- **ä½¿ç”¨æŒ‡å—**: putty-ssh-tunnel-guide.md
- **æ¸¬è©¦æŒ‡ä»¤**: ssh-test-commands.md
- **ä¸»è¦å·¥å…·**: putty-tunnel-test.ps1
- **ç’°å¢ƒé…ç½®**: docker-compose.yml

### ğŸ¯ æ˜æ—¥å­¸ç¿’é å‘Š

**Day 2: PuTTY åŸºç¤æ“ä½œèˆ‡é€£ç·šè¨­å®š**
- æ·±å…¥å­¸ç¿’ PuTTY GUI æ“ä½œ
- æŒæ¡å„ç¨®é€£ç·šè¨­å®šé¸é …
- å­¸ç¿’ Session ç®¡ç†å’ŒåŒ¯å‡ºå…¥
- å¯¦ä½œä¸åŒé¡å‹çš„ SSH é€£ç·š

### âš ï¸ å¯¦ä½œéç¨‹ä¸­é‡åˆ°çš„å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

#### å•é¡Œ 1: Docker Compose ç‰ˆæœ¬è­¦å‘Š
**å•é¡Œæè¿°**:
```
level=warning msg="docker-compose.yml: the attribute version is obsolete"
```

**è§£æ±ºæ–¹æ¡ˆ**:
```yaml
# ç§»é™¤ docker-compose.yml ä¸­çš„ version å±¬æ€§
# å¾ï¼š
version: '3.8'
services:
  ...

# æ”¹ç‚ºï¼š
services:
  ...
```

**å­¸ç¿’é‡é»**: æ–°ç‰ˆ Docker Compose ä¸å†éœ€è¦ version å±¬æ€§

#### å•é¡Œ 2: Docker ç¶²è·¯è¡çª
**å•é¡Œæè¿°**:
```
Error response from daemon: invalid pool request: Pool overlaps with other one on this address space
```

**åŸå› åˆ†æ**: 
- åŸå§‹ç¶²è·¯é…ç½®èˆ‡ä¸»æ©Ÿç¾æœ‰ç¶²è·¯é‡ç–Š
- `172.25.0.0/16` å’Œ `192.168.200.0/24` èˆ‡ç¾æœ‰ç¶²è·¯è¡çª

**è§£æ±ºæ–¹æ¡ˆ**:
```yaml
# æ›´æ–° docker-compose.yml ç¶²è·¯é…ç½®
networks:
  public-net:
    driver: bridge
    ipam:
      config:
        - subnet: 172.30.0.0/16  # åŸ: 172.25.0.0/16
  internal-net:
    driver: bridge
    ipam:
      config:
        - subnet: 10.100.0.0/24  # åŸ: 192.168.200.0/24
```

**æ¸…ç†æŒ‡ä»¤**:
```powershell
docker-compose down
docker network prune -f
docker rm -f $(docker ps -aq)
```

#### å•é¡Œ 3: SSH ä¸»æ©Ÿé‡‘é‘°é©—è­‰å¤±æ•—
**å•é¡Œæè¿°**:
```
Host key verification failed.
```

**åŸå› åˆ†æ**: Windows ä¸»æ©Ÿç¬¬ä¸€æ¬¡é€£æ¥ SSH æœå‹™å™¨éœ€è¦æ¥å—ä¸»æ©Ÿé‡‘é‘°

**è§£æ±ºæ–¹æ¡ˆ**:
```powershell
# æ–¹æ³• 1: æ‰‹å‹•æ¥å—ä¸»æ©Ÿé‡‘é‘°
echo y | plink -ssh -P 2222 sshuser@localhost -pw password123 "echo 'SSHæ¸¬è©¦'"

# æ–¹æ³• 2: åœ¨è…³æœ¬ä¸­è‡ªå‹•è™•ç†
function Setup-SSHHostKey {
    $testConnection = & plink -ssh -P 2222 -pw "password123" -batch sshuser@localhost "echo 'SSH é€£ç·šæ¸¬è©¦'"
    if ($LASTEXITCODE -ne 0) {
        # è™•ç†ä¸»æ©Ÿé‡‘é‘°æ¥å—é‚è¼¯
    }
}
```

#### å•é¡Œ 4: Port è¡çªå•é¡Œ
**å•é¡Œæè¿°**: 
- Port 8080 è¢« Chrome ä½”ç”¨
- Port 8083 è¢« Apache (httpd) ä½”ç”¨

**è¨ºæ–·æŒ‡ä»¤**:
```powershell
netstat -ano | findstr ":8080 :8081 :8083"
Get-Process -Id [PID] | Select-Object Id,ProcessName,Path
```

**è§£æ±ºæ–¹æ¡ˆ**: æ›´æ› Port é…ç½®é¿å…è¡çª
```powershell
# åŸå§‹ Port é…ç½®
8080 â†’ target-server-1:80  # Web æœå‹™
8081 â†’ target-server-1:22  # SSH æœå‹™  
8083 â†’ target-server-2:3306 # è³‡æ–™åº«æœå‹™

# æ–°çš„ Port é…ç½®
8090 â†’ target-server-1:80  # Web æœå‹™
8091 â†’ target-server-1:22  # SSH æœå‹™
8093 â†’ target-server-2:3306 # è³‡æ–™åº«æœå‹™
```

#### å•é¡Œ 5: PuTTY plink åƒæ•¸éŒ¯èª¤
**å•é¡Œæè¿°**:
```
plink: '*' is not a valid format for a manual host key specification
```

**åŸå› åˆ†æ**: `-hostkey "*"` åƒæ•¸æ ¼å¼ä¸æ­£ç¢º

**è§£æ±ºæ–¹æ¡ˆ**:
```powershell
# éŒ¯èª¤çš„å¯«æ³•
plink -ssh -P 2222 -pw "password123" -batch -hostkey "*" sshuser@localhost

# æ­£ç¢ºçš„å¯«æ³• (ç§»é™¤ -hostkey åƒæ•¸)
plink -ssh -P 2222 -pw "password123" -batch sshuser@localhost
```

#### å•é¡Œ 6: PowerShell åŸ·è¡Œæ¬Šé™
**å•é¡Œæè¿°**: PowerShell è…³æœ¬åŸ·è¡Œè¢«é˜»æ­¢

**è§£æ±ºæ–¹æ¡ˆ**:
```powershell
# æª¢æŸ¥åŸ·è¡ŒåŸå‰‡
Get-ExecutionPolicy

# è¨­å®šåŸ·è¡ŒåŸå‰‡ (ä»¥ç®¡ç†å“¡èº«ä»½åŸ·è¡Œ)
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# æˆ–æš«æ™‚ç¹é
PowerShell -ExecutionPolicy Bypass -File .\putty-tunnel-test.ps1
```

### ğŸ”§ æœ€çµ‚æˆåŠŸçš„å®Œæ•´æµç¨‹

#### 1. ç’°å¢ƒæª¢æŸ¥èˆ‡æº–å‚™
```powershell
# æª¢æŸ¥ Port ä½¿ç”¨æƒ…æ³
netstat -an | findstr ":8090 :8091 :8093"

# ç¢ºèª Docker ç’°å¢ƒ
docker --version
docker-compose --version
```

#### 2. åŸ·è¡Œå®Œæ•´æ¸¬è©¦
```powershell
# é€²å…¥ Day1 è³‡æ–™å¤¾
cd Day1

# ä½¿ç”¨ä¿®æ­£å¾Œçš„è…³æœ¬åŸ·è¡Œå®Œæ•´æµç¨‹
.\putty-tunnel-test.ps1 -All

# æˆ–ä½¿ç”¨äº’å‹•å¼é¸å–®
.\putty-tunnel-test.ps1
# é¸æ“‡é¸é … 5 - åŸ·è¡Œå®Œæ•´æ¸¬è©¦æµç¨‹
```

#### 3. é©—è­‰æ¸¬è©¦çµæœ
```powershell
# Web æœå‹™æ¸¬è©¦
curl http://localhost:8090

# SSH æœå‹™æ¸¬è©¦
plink -ssh -P 8091 -pw "rootpassword" -batch root@localhost "echo 'SSH Tunnel æˆåŠŸ'"

# è³‡æ–™åº«æœå‹™æ¸¬è©¦
Test-NetConnection localhost -Port 8093
```

### ğŸ“Š æœ€çµ‚æ¸¬è©¦çµæœ

âœ… **æ‰€æœ‰æ¸¬è©¦é …ç›®é€šé**:
- ğŸ”§ ç’°å¢ƒè¨­å®š: PuTTY æª¢æŸ¥ã€Docker å•Ÿå‹•ã€SSH é‡‘é‘°è¨­å®š
- ğŸ”— SSH Tunnel å»ºç«‹: åŸºæœ¬é€£ç·šæ¸¬è©¦ã€å¤šé‡ Port Forwarding
- ğŸ”Œ Port è½‰ç™¼é©—è­‰: 8090 (Web)ã€8091 (SSH)ã€8093 (DB)
- ğŸ§ª æœå‹™åŠŸèƒ½æ¸¬è©¦: Web æœå‹™ã€SSH æœå‹™ã€è³‡æ–™åº«æœå‹™
- ğŸ§¹ ç’°å¢ƒæ¸…ç†: ç¨‹åºæ¸…ç†ã€Docker ç’°å¢ƒåœæ­¢

### ğŸ’¡ å­¸ç¿’å¿ƒå¾—

ä»Šå¤©æˆåŠŸå»ºç«‹äº†å®Œæ•´çš„ SSH Tunnel æ¸¬è©¦ç’°å¢ƒï¼Œæ·±å…¥ç†è§£äº†ä¸‰å±¤æ¶æ§‹çš„è¨­è¨ˆåŸç†ã€‚é€é Docker å®¹å™¨åŒ–æŠ€è¡“ï¼Œæˆ‘å€‘æ¨¡æ“¬äº†çœŸå¯¦çš„ä¼æ¥­ç¶²è·¯ç’°å¢ƒï¼Œå¯¦ç¾äº†å…§å¤–ç¶²éš”é›¢çš„å®‰å…¨æ¶æ§‹ã€‚

æœ€é‡è¦çš„æ”¶ç©«æ˜¯ç†è§£äº† SSH Tunnel çš„æ ¸å¿ƒåƒ¹å€¼ï¼š**é€éå®‰å…¨çš„ SSH é€£ç·šï¼Œè®“æˆ‘å€‘å¯ä»¥å®‰å…¨åœ°å­˜å–å…§éƒ¨ç¶²è·¯æœå‹™ï¼Œè€Œä¸éœ€è¦ç›´æ¥æš´éœ²é€™äº›æœå‹™åˆ°å¤–éƒ¨ç¶²è·¯**ã€‚é€™åœ¨ä¼æ¥­ç’°å¢ƒä¸­å…·æœ‰é‡è¦çš„å®‰å…¨æ„ç¾©ã€‚

**å¯¦ä½œéç¨‹ä¸­çš„é‡è¦å­¸ç¿’**:
1. **å•é¡Œè¨ºæ–·èƒ½åŠ›**: å­¸æœƒå¦‚ä½•ç³»çµ±æ€§åœ°åˆ†æå’Œè§£æ±ºæŠ€è¡“å•é¡Œ
2. **ç’°å¢ƒé…ç½®æŠ€å·§**: æŒæ¡ Docker ç¶²è·¯é…ç½®å’Œ Port è¡çªè§£æ±º
3. **è‡ªå‹•åŒ–æ€ç¶­**: é€éè…³æœ¬è‡ªå‹•åŒ–è¤‡é›œçš„é…ç½®å’Œæ¸¬è©¦æµç¨‹
4. **å®‰å…¨æ„è­˜**: ç†è§£ SSH ä¸»æ©Ÿé‡‘é‘°é©—è­‰çš„é‡è¦æ€§

äº’å‹•å¼æ¸¬è©¦å·¥å…·å¤§å¤§ç°¡åŒ–äº†æ“ä½œæµç¨‹ï¼Œè®“è¤‡é›œçš„ç’°å¢ƒé…ç½®è®Šå¾—ç°¡å–®æ˜“ç”¨ã€‚é€éä»Šå¤©çš„å¯¦ä½œï¼Œä¸åƒ…æŒæ¡äº†æŠ€è¡“æ“ä½œï¼Œæ›´é‡è¦çš„æ˜¯åŸ¹é¤Šäº†è§£æ±ºå•é¡Œçš„ç³»çµ±æ€§æ€ç¶­ã€‚

---

**å­¸ç¿’ç‹€æ…‹**: âœ… å®Œæˆ  
**ç¸½å­¸ç¿’æ™‚é–“**: 4 å°æ™‚
